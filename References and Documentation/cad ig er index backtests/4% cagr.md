# 4% CAGR Pattern Discovery & Strategy Generation for CAD IG ER Index

## When to Use

- Use this playbook when targeting a >4% CAGR on the CAD IG ER index under the documented constraints (no leverage, no shorting, binary positioning, 20-day hold).
- Apply it before any agent begins pattern discovery so the mandatory clarification prompts and validation phases are enforced.
- Reference it when reviewing experiments to confirm they respected the specification gating, regime analyses, and statistical rigor demanded for this benchmark.
- Consult it while designing automation; the document details how to integrate wavelet analysis, meta-labeling, genetic optimization, and VectorBT validation for this specific index.
- If you are exploring a different CAGR target or index, switch to the relevant framework; this guide is purpose-built for CAD IG ER >4% CAGR initiatives.

## ⚠️ CRITICAL: AI MUST CLARIFY SPECIFICATIONS BEFORE IMPLEMENTATION

**Before implementing ANY pattern discovery or analysis for the 4% CAGR objective, the AI MUST activate the Precision Clarification Engine and ask/clarify the following specifications:**

### **PHASE 1: PRECISION CLARIFICATION ENGINE - 4% CAGR OBJECTIVE**

```
"To ensure we precisely target your >4% CAGR objective for the CAD IG ER index, I need to clarify the following. I will ask 2-3 questions for simple tasks, and 5-7 for complex ones, aiming for 95% confidence before proceeding. I will also probe for edge cases and challenge assumptions.

Please provide specific answers for each point, or confirm the default if it aligns with your goals.

**MANDATORY SPECIFICATION QUESTIONS (4% CAGR Focus):**

#### **1. Core Objective Parameters (REQUIRED)**
- **Target CAGR**: `[AI MUST ASK: "What is your exact target Compound Annual Growth Rate? (Default: >4%)"]`
- **Target Index**: `[AI MUST ASK: "Which specific index are we analyzing? (Default: cad_ig_er_index)"]`
- **Leverage Allowed**: `[AI MUST ASK: "Is the use of leverage permitted? (Default: No)"]`
- **Shorting Allowed**: `[AI MUST ASK: "Is short selling allowed for this strategy? (Default: No)"]`
- **Positioning Type**: `[AI MUST ASK: "What type of positioning is required? (Default: Binary - fully in or fully out)"]`
- **Minimum Holding Period**: `[AI MUST ASK: "What is the minimum number of days a trade must be held? (Default: 20 days)"]`
- **Maximum Holding Period**: `[AI MUST ASK: "Is there a maximum holding period for trades? (Default: No Max)"]`
- **Signal to Trade Lag**: `[AI MUST ASK: "What is the timing relationship between signal generation and trade execution? (Default: Signal t+0, Trade t+1 day)"]`

#### **2. Data & Market Context (REQUIRED)**
- **Data Frequency**: `[AI MUST ASK: "What is the frequency of the CAD IG ER index data you will provide? (Default: Daily)"]`
- **Date Range**: `[AI MUST ASK: "What is the specific historical date range for analysis? (Default: Whole available range, unless specified)"]`
- **Data Source**: `[AI MUST ASK: "What is the primary source of your data? (Default: CSV file, unless specified)"]`
- **Volume Data Availability**: `[AI MUST ASK: "Do you have reliable volume data for the index? (Default: none) (Crucial for certain bar types)"]`

#### **3. Trading Objectives & Constraints (REQUIRED)**
- **Risk Tolerance**: `[AI MUST ASK: "What is your maximum acceptable drawdown? (e.g., 5%, 10%, 15%)"]`
- **Implementation Language**: `[AI MUST ASK: "What programming language should the implementation be in? (Default: Python)"]`
- **Real-time Trading**: `[AI MUST ASK: "Is this strategy intended for real-time trading or purely backtesting? (Default: No real-time)"]`
- **ML Complexity**: `[AI MUST ASK: "What level of Machine Learning complexity are you comfortable with? (Default: Simple and Advanced ML)"]`

#### **4. Pattern Discovery & Validation Scope (REQUIRED)**
- **Pattern Types to Prioritize**: `[AI MUST ASK: "Which categories of patterns should be prioritized? (Default: All, use AI judgment)"]`
- **Statistical Significance Threshold**: `[AI MUST ASK: "What p-value threshold do you require for statistical significance? (Default: Use AI judgment)"]`
- **Out-of-Sample Validation**: `[AI MUST ASK: "Do you require rigorous out-of-sample validation? (Default: Yes)"]`
- **Walk-Forward Period**: `[AI MUST ASK: "What walk-forward period do you prefer for validation? (Default: Use AI judgment)"]`

#### **5. AI Interaction & Output Preferences (REQUIRED)**
- **Output Format**: `[AI MUST ASK: "What is your preferred output format for results and code? (e.g., Markdown, Jupyter Notebook, Python script)"]`
- **Level of Detail**: `[AI MUST ASK: "What level of detail do you require in explanations and documentation? (e.g., High-level, detailed, expert-level)"]`
- **Interactivity**: `[AI MUST ASK: "Do you prefer interactive elements (e.g., plots, dashboards) in the output?"]`
- **Assumptions**: `[AI MUST ASK: "Are there any specific assumptions I should make or avoid?"]`
```

### **AI IMPLEMENTATION PROTOCOL (Enhanced with Optimized Prompt Engineer)**

**The AI MUST follow this sequence, integrating the Optimized Prompt Engineer phases:**

1. **PHASE 1: PRECISION CLARIFICATION ENGINE**:
   - **ASK ALL MANDATORY SPECIFICATION QUESTIONS** (from section 1 above) before any implementation.
   - **CONFIRM EACH ANSWER** with the user, ensuring 95% confidence in understanding.
   - **PROBE FOR EDGE CASES** and challenge assumptions related to the 4% CAGR objective and constraints.

2. **PHASE 2: ELITE PERSPECTIVE ANALYSIS - 4% CAGR Strategy**:
   - Once specifications are clear, activate this phase to analyze the 4% CAGR objective from a top 0.1% quantitative researcher perspective.
   - **MARKET INEFFICIENCY ANALYSIS**:
     - What specific inefficiency in CAD IG ER markets are we exploiting to achieve >4% CAGR with these constraints?
     - How does this compare to institutional bond trading strategies or other low-leverage, no-shorting approaches?
     - What competitive advantage does this pattern provide given the binary positioning and minimum hold period?
     - What are the hidden risks and edge cases for a >4% CAGR target under these conditions?
   - **STRATEGIC PATTERN SELECTION**:
     - Which pattern types (from the `iterate to find best patterns.md` framework) are most likely to align with a >4% CAGR, no leverage/shorting, binary positioning, and 20-day min hold?
     - How do these patterns complement each other to achieve the target?
     - What market regimes are most conducive to these patterns generating >4% CAGR?

3. **PHASE 3: PARADIGM CHALLENGE - Breakthrough Discovery**:
   - Challenge conventional thinking about achieving >4% CAGR with the given constraints.
   - **ASSUMPTION VALIDATION**:
     - Are there any implicit assumptions in the >4% CAGR target or constraints that need to be re-evaluated?
     - What if the market structure changes? How robust is the >4% CAGR target?
   - **ALTERNATIVE PERSPECTIVES**:
     - Could a non-obvious combination of patterns yield superior results?
     - Are there any "black swan" patterns that could be identified?

4. **PHASE 4: CONCEPTUAL VISUALIZATION - Complex Method Mapping**:
   - Visually map the proposed pattern discovery and strategy generation process, especially for complex ML or multi-scale techniques, to ensure clarity.

5. **PHASE 5: NOBEL LAUREATE RESEARCH METHODOLOGY**:
   - Apply scientific rigor to the pattern discovery process for the >4% CAGR objective.
   - **FUNDAMENTAL RESEARCH QUESTIONS**:
     - What fundamental market principles are we testing to achieve >4% CAGR?
     - How can we design experiments to prove/disprove hypotheses about patterns leading to >4% CAGR?
   - **SCIENTIFIC RIGOR REQUIREMENTS**:
     - Null hypothesis testing for each pattern identified.
     - Multiple testing corrections for pattern discovery.
     - Out-of-sample validation with proper statistical tests, specifically targeting the >4% CAGR.

6. **CUSTOMIZE THE FRAMEWORK** based on all clarified specifications and insights from the above phases.

7. **PROVIDE DETAILED IMPLEMENTATION PLAN** with specific parameters and chosen techniques.

8. **ONLY THEN PROCEED** with pattern discovery, backtesting, and strategy generation.

---

## **Current User Specifications (Based on Image & Defaults)**

- **Target CAGR**: `>4%`
- **Target Index**: `cad_ig_er_index`
- **Leverage Allowed**: `No`
- **Shorting Allowed**: `No`
- **Positioning Type**: `Binary (fully in or fully out)`
- **Minimum Holding Period**: `20 days`
- **Maximum Holding Period**: `No Max`
- **Signal to Trade Lag**: `Signal t+0, Trade t+1 day`
- **Data Frequency**: `Daily`
- **Date Range**: `Whole available range`
- **Data Source**: `CSV file`
- **Volume Data Availability**: `[AI MUST ASK]`
- **Risk Tolerance**: `Modest`
- **Implementation Language**: `Python`
- **Real-time Trading**: `No real-time`
- **ML Complexity**: `Simple and Advanced ML`
- **Pattern Types to Prioritize**: `All, use AI judgment`
- **Statistical Significance Threshold**: `Use AI judgment`
- **Out-of-Sample Validation**: `Yes`
- **Walk-Forward Period**: `Use AI judgment`
- **Output Format**: `[AI MUST ASK]`
- **Level of Detail**: `[AI MUST ASK]`
- **Interactivity**: `[AI MUST ASK]`
- **Assumptions**: `[AI MUST ASK]`

---

## **Pattern Discovery & Strategy Generation Approach (Inspired by `Cad_ig_er_index iterate to find best patterns.md`)**

To achieve the >4% CAGR objective under the specified constraints, this framework will leverage the advanced methodologies outlined in the `Cad_ig_er_index iterate to find best patterns.md` file. The focus will be on identifying robust patterns that specifically meet the return target without leverage or shorting, with binary positioning, and a minimum 20-day hold.

### **1. Advanced Financial Data Engineering & Sampling**
- **Information-Driven Bars**: Depending on data availability (e.g., if tick data becomes available), dollar bars or volume bars will be considered to capture market activity more effectively than time bars, especially for identifying patterns that lead to consistent >4% CAGR.
- **Fractional Differentiation**: Applied to achieve stationarity while preserving memory, crucial for patterns in a low-leverage, long-hold environment.
- **Sequential Bootstrap**: Used for robust backtesting and validation, accounting for the non-IID nature of financial data and overlapping labels.

### **2. Advanced Labeling & Meta-Labeling Framework**
- **Triple-Barrier Method**: Will be customized to define profit-taking, stop-loss, and time-limit barriers specifically calibrated for the >4% CAGR target and the 20-day minimum holding period.
- **Meta-Labeling**: Employed to filter out false positive signals and improve the precision of patterns, ensuring only high-conviction trades contributing to the CAGR target are considered.

### **3. Machine Learning Enhancements for Pattern Discovery**
- **Feature Importance & Selection**: Advanced techniques (e.g., SHAP, LIME) will be used to identify features most predictive of >4% CAGR outcomes under the given constraints.
- **Ensemble Methods**: Stacking, boosting, and bagging will combine multiple models to improve predictive accuracy and robustness of pattern signals.
- **Deep Learning**: Autoencoders, VAEs, and Transformers will be applied to uncover complex, non-linear patterns in time series data that might lead to the desired CAGR.

### **4. Advanced Statistical Pattern Recognition**
- **Fractal Analysis & Chaos Theory**: Hurst exponent, fractal dimension, Lyapunov exponents will be used to understand the persistence and predictability of the CAD IG ER index, identifying regimes conducive to >4% CAGR.
- **Nonlinear Dynamics & Information Theory**: Mutual information and transfer entropy will uncover hidden dependencies and information flow between market variables and the index's movements.
- **Copula Analysis**: To model complex dependencies between different market factors and the index, crucial for understanding risk and return profiles for the target CAGR.

### **5. Advanced Regime Detection & Change Point Analysis**
- **Hidden Markov Models (HMMs)**: To identify distinct market regimes (e.g., trending, mean-reverting, volatile) and tailor pattern application to regimes most likely to generate >4% CAGR.
- **Change Point Detection**: To identify shifts in market behavior that might invalidate existing patterns or signal the emergence of new ones.
- **Regime-Dependent Volatility Modeling**: To adapt risk management and position sizing based on the current market regime, optimizing for the CAGR target.

### **6. Pattern Evolution & Adaptive Modification**
- **Pattern Lifecycle Tracking**: To monitor the performance of identified patterns over time, ensuring they continue to contribute to the >4% CAGR target.
- **Adaptive Pattern Modification**: Parameters of patterns will be dynamically adjusted to maintain performance in changing market conditions.
- **Pattern Competition & Survival**: A system will be implemented to allow patterns to compete, with only the most robust and profitable (towards the >4% CAGR) surviving and evolving.

### **7. Multi-Scale Analysis & Wavelet Pattern Detection**
- **Wavelet Analysis**: To decompose the index into different frequency components, identifying patterns that manifest across various time scales, from short-term movements to long-term trends, relevant for the 20-day minimum hold.
- **Empirical Mode Decomposition (EMD)**: To extract intrinsic mode functions (IMFs) and analyze their contribution to the overall index movement, revealing underlying patterns.
- **Multi-Fractal Analysis**: To understand the multi-fractal nature of the index, providing insights into its complexity and predictability.

### **8. Pattern Synthesis Engine**
- **Pattern Combination & Generation**: Techniques like genetic crossover and neural fusion will be used to combine existing patterns or generate new variations, aiming to create more robust strategies that consistently achieve >4% CAGR.
- **Pattern Validation & Selection**: A rigorous system will validate synthesized patterns for statistical significance, out-of-sample performance, and robustness, with a strong emphasis on achieving the specified CAGR target under the given constraints.

### **9. Genetic Algorithm Optimization**
- **Multi-Objective Optimization**: Genetic algorithms will be used to optimize pattern parameters and combinations, balancing the >4% CAGR target with other objectives like drawdown control and consistency, given the no-leverage/shorting and binary positioning constraints.

### **10. VectorBT Backtesting & Validation Framework**
- **Precise Backtesting**: VectorBT will be used for high-fidelity backtesting, ensuring accurate simulation of trade execution, especially for the t+0 signal, t+1 trade timing.
- **Temporal Integrity**: Strict checks for look-ahead bias and survivorship bias will be implemented.
- **Statistical Validation**: Significance testing and multiple testing corrections will be applied to ensure the identified patterns are not merely a result of chance.
- **Performance & Risk Validation**: Comprehensive metrics (Sharpe, Sortino, Calmar, Max Drawdown, VaR, CVaR) will be used, with a specific focus on validating the >4% CAGR target and adherence to risk tolerance. Stress testing will be performed to assess robustness.
- **Overfitting Detection**: In-sample vs. out-of-sample performance, parameter stability, and cross-validation will be rigorously applied to prevent overfitting.

---

## **Next Steps for AI**

1. **Activate Phase 1: Precision Clarification Engine** and ask the user all mandatory specification questions listed above.
2. **Confirm each answer** with the user.
3. **Proceed through Phases 2-5** to gain deeper insights and refine the approach.
4. **Present a detailed implementation plan** based on the clarified specifications and the chosen advanced techniques.
5. **Await user confirmation** before proceeding with any code generation or pattern discovery.
